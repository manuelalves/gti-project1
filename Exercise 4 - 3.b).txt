declare default element namespace "http://www.parlamento.pt";\
let $doc := doc("/Users/jessicaribeiro/Desktop/IST/1semestre/GTI/Projecto/gti-project1/parliament-data.xml")

let $interv := (
 for $session in $doc//session
 let $p := distinct-values($session/speech/@politician)
 return  $p
)

for $politician in $doc//politician
let $code := $politician/@code
let $name := $politician/text()
let $count := count(index-of($interv, $code))
return    
copy $politicians := $politician
 	 modify (
  	 insert node ( attribute num-sessions \{$count\})
  	 into $politicians )
	 return  <politician><name>\{$name\}</name><num-sessions>\{$count\}</num-sessions></politician>

}
